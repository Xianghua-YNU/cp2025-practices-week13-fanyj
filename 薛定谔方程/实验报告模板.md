# 薛定谔方程 - 实验报告

## 1. 实验目的简述

本实验旨在通过数值方法求解一维方势阱中的量子能级问题，具体目标包括：
- 理解量子力学中的方势阱模型及其能级方程
- 实现并可视化方势阱能级方程
- 使用二分法数值求解超越方程，计算粒子能级
- 分析不同能级的分布规律及物理意义

## 2. 方法简述

请简要描述您实现的算法和方法，特别是：
- 如何处理方程中的数值计算问题（如避免过小数值导致的计算误差）
- 二分法求解超越方程的具体实现策略
- 如何区分和处理偶宇称和奇宇称能级

在处理数值计算问题时，通过将能量从电子伏特（eV）转换为焦耳（J），并利用统一因子 (w**2 * m) / (2 * HBAR ** 2) 来计算能级方程中的函数值，避免了过小数值导致的计算误差。同时，在计算过程中使用 np.errstate 上下文管理器处理可能的除零错误，并用 np.where 函数处理计算结果中的无穷大与 NaN 值。

二分法求解超越方程时，首先根据能级序号的奇偶性选择对应的能级方程（偶宇称用 energy_equation_even，奇宇称用 energy_equation_odd ）。初始化搜索区间后，检查区间端点函数值符号是否相反，若相同则抛出异常。迭代过程中，不断取区间中点计算函数值，根据函数值符号调整搜索区间，当区间长度小于设定精度或中点函数值足够接近 0 时，将中点作为近似根返回。

对于偶宇称和奇宇称能级，分别定义了 energy_equation_even 和 energy_equation_odd 函数来表示其对应的能级方程，通过计算方程两边的差值来为二分法提供判断依据 ，在二分法中根据能级序号的奇偶性选择合适的方程进行求解。

## 3. 实验结果

### 3.1 能级方程可视化

请在此处粘贴您生成的能级方程图像，并简要说明图中各曲线的物理意义以及能级对应的交点位置。

![image](https://github.com/user-attachments/assets/3e83a445-b2ec-48ce-a76f-9050f0449df9)


图像说明：
图中蓝色曲线 y1 = tan(sqrt(w^2mE/2hbar^2)) ，红色曲线 y2 = sqrt((V - E)/E) 对应偶宇称情况，绿色曲线 y3 = -sqrt(E/(V - E)) 对应奇宇称情况。能级对应的交点即不同曲线相交之处，这些交点的横坐标值即为可能的能级取值 ，反映了粒子在方势阱中允许存在的能量状态。
### 3.2 能级计算结果

请列出您计算得到的前6个能级值，并与参考值进行比较：

![image](https://github.com/user-attachments/assets/f98a3ad3-ae5d-47c2-8cc6-e1c82d27f5bf)


## 4. 分析与讨论

### 4.1 能级分布规律

请分析计算得到的能级分布规律，特别是：
- 能级间隔是否均匀？随着能级增加，间隔如何变化？
- 这种分布规律与经典物理有何不同？体现了量子力学的哪些特性？

计算得到的能级间隔不均匀，随着能级增加，能级间隔逐渐增大。这与经典物理不同，经典物理中粒子能量可连续取值，而量子力学中能级是离散的，体现了量子化特性。这种离散性源于微观粒子的波粒二象性，粒子在势阱中形成驻波，只有满足特定波长条件的状态才能存在，导致能级离散，且高能量状态对应的波长更短，能级间隔更大。

### 4.2 计算方法的精度与效率

讨论您使用的二分法在求解此类问题时的优缺点：
- 计算精度如何？是否足以满足物理问题的需求？
- 计算效率如何？是否有可能使用其他方法（如牛顿法）提高效率？

二分法计算精度可通过设定的精度参数控制，在本次实验中，能够满足对能级计算的物理需求。其优点是算法简单、稳定，对函数性质要求低；缺点是收敛速度相对较慢。牛顿法理论上收敛速度更快，若函数导数容易计算，可考虑使用牛顿法提高效率，但牛顿法对初始值选取要求高，若初始值选择不当可能不收敛或收敛到错误的根。

### 4.3 思考题

1. 如果增加势阱宽度 $w$，能级将如何变化？请给出物理解释。

增加势阱宽度 w ，能级将降低且能级间隔减小。从物理角度看，势阱变宽，粒子活动空间增大，根据不确定性原理，动量不确定性减小，能量也随之减小。同时，驻波波长可增大，允许更多的状态存在，能级间隔因此变小。
2. 如果将势阱高度 $V$ 改变，对能级分布有何影响？特别是，当 $V \to \infty$ 时，能级方程将如何简化？

势阱高度 V 改变会影响能级取值范围和数量。V 增大，能级整体升高，可容纳的束缚态能级数量增加。当 \(V \to \infty\) 时，粒子被完全限制在势阱内，边界条件使得波函数在边界处为 0 ，能级方程简化为无限深方势阱能级方程，能级与 \(n^2\) 成正比（n 为能级序号）。

## 5. 结论

总结本实验的主要发现和收获，包括对量子力学基本概念的理解以及数值方法在物理问题中的应用。

本实验通过数值方法成功求解一维方势阱量子能级问题。理解了方势阱模型及其能级方程，掌握了二分法求解超越方程的应用，通过可视化和计算结果分析，明确了能级离散分布等量子力学特性。认识到数值方法在处理物理问题时的重要性，同时也体会到量子力学与经典物理的差异，为进一步研究微观物理世界奠定了基础。

## 核心代码片段

请粘贴您实现的关键函数代码（如二分法求解能级的函数），并简要说明代码的核心思路。

```python
def find_energy_level_bisection(n, V, w, m, precision=0.001, E_min=0.001, E_max=None):
    if E_max is None:
        E_max = V - 0.001
    if n % 2 == 0:
        equation = lambda E: energy_equation_even(E, V, w, m)
    else:
        equation = lambda E: energy_equation_odd(E, V, w, m)
    a, b = E_min, E_max
    fa, fb = equation(a), equation(b)
    if fa * fb > 0:
        raise ValueError(f"无法在给定区间 [{a}, {b}] 内找到第 {n} 个能级")
    while (b - a) > precision:
        c = (a + b) / 2
        fc = equation(c)
        if abs(fc) < 1e-10:
            return c
        if fa * fc < 0:
            b = c
            fb = fc
        else:
            a = c
            fa = fc
    return (a + b) / 2
```

代码说明：
该函数根据能级序号 n 选择对应的能级方程，初始化搜索区间并检查端点函数值符号。通过二分法不断迭代，取区间中点计算函数值，根据函数值符号调整区间，直至满足精度要求或找到足够接近根的中点，最终返回近似能级值。
