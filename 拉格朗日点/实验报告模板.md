# 拉格朗日点 - 实验报告

## 1. 实验目的简述

本实验旨在通过数值方法求解地球-月球系统中L1拉格朗日点的位置，具体目标包括：
- 理解拉格朗日点的物理意义及其在天体力学中的重要性
- 推导L1点位置满足的方程
- 实现并比较不同的数值求根方法（牛顿法、弦截法）
- 分析数值方法的收敛性和精度

## 2. 方法简述

请简要描述您实现的算法和方法，特别是：
- L1点位置方程的推导过程和物理意义
- L1 点位置方程的推导过程和物理意义：在地球 - 月球系统中，L1 拉格朗日点处的物体受到地球引力、月球引力和离心力的作用。根据牛顿万有引力定律和圆周运动向心力公式，地球引力为\(F_{地}=\frac{GM}{r^{2}}\) ，月球引力为\(F_{月}=\frac{Gm}{(R - r)^{2}}\) ，离心力为\(F_{离}=\omega^{2}r\) 。在 L1 点，这三个力达到平衡，即地球引力减去月球引力等于离心力，得到方程\(\frac{GM}{r^{2}}-\frac{Gm}{(R - r)^{2}}=\omega^{2}r\) ，其物理意义是描述了在该点上物体所受引力与离心力平衡，从而可相对地球和月球保持静止。
- 牛顿法和弦截法的实现策略
- 牛顿法基于目标方程\(f(x)\)及其导数\(f'(x)\) ，通过迭代公式\(x_{n + 1}=x_{n}-\frac{f(x_{n})}{f'(x_{n})}\)逐步逼近方程的根。弦截法不需要计算导数，通过迭代公式\(x_{n + 1}=x_{n}-\frac{f(x_{n})(x_{n}-x_{n - 1})}{f(x_{n})-f(x_{n - 1})}\) ，利用区间两端点的函数值来逼近根。
- 初值或初始区间的选择依据
- 对于牛顿法，初值选择大约在地月距离的 90% 处，即\(r_0 = 3.5e8\) m ，这是基于对 L1 点位置的大致估计。对于弦截法，初始区间选择为\([3.2e8, 3.7e8]\) m ，该区间包含了可能的 L1 点位置，且区间两端点函数值异号，满足弦截法的使用条件。

_在此处填写您的方法描述（约200-300字）_

## 3. 实验结果

### 3.1 L1点位置方程可视化

请在此处粘贴您生成的L1点位置方程图像，并简要说明图中的零点位置及其物理意义。
![image](https://github.com/user-attachments/assets/b5e076b3-7421-467c-bc59-35eabaea128a)




图像说明：
图中曲线为 L1 点位置方程的函数图像，曲线与 x 轴交点即零点位置，代表满足地球引力、月球引力和离心力平衡的从地心到 L1 点的距离 r 。该位置上物体所受合力为零，可在地球 - 月球系统中保持相对静止。

### 3.2 数值求解结果

请列出使用不同方法求解L1点位置的结果：

![image](https://github.com/user-attachments/assets/a07bafd4-0af2-4194-ad04-6209849e9f79)

### 3.3 不同方法的结果比较

请计算不同方法之间的结果差异：

![image](https://github.com/user-attachments/assets/578f7673-082f-45f6-9ccd-cde34da1a59a)

## 4. 分析与讨论

### 4.1 L1点的物理意义

请分析L1点的物理意义及其在空间任务中的应用价值：
- L1点为什么能保持卫星相对于地球和月球静止？
- 在L1点放置卫星有什么实际应用？

L1 点能保持卫星相对于地球和月球静止，是因为在该点卫星所受地球引力、月球引力与离心力达到平衡。从受力角度看，合力为零，卫星无需额外动力就能维持相对位置。在空间任务中，L1 点放置卫星有诸多应用。例如，可用于天文观测，因其位置能减少地球和月球的干扰，获得更清晰的宇宙观测视野；还可用于空间环境监测，实时监测太阳风等空间环境变化，为地球空间环境预警提供数据 。
### 4.2 数值方法的比较

讨论牛顿法和弦截法在求解此问题时的优缺点：
- 收敛速度比较
- 对初值/初始区间的敏感性
- 计算复杂度和实现难度

收敛速度比较：牛顿法一般收敛速度较快，若初值选取合适，可快速逼近精确解。弦截法相对牛顿法收敛速度稍慢，特别是在远离精确解时，迭代次数可能较多。
对初值 / 初始区间的敏感性：牛顿法对初值要求较高，若初值远离精确解，可能不收敛或收敛到错误的根。弦截法依赖初始区间，需保证区间两端点函数值异号，否则可能不收敛，但对区间内初值的敏感性相对较弱。
计算复杂度和实现难度：牛顿法需计算目标方程的导数，增加了计算复杂度，但实现思路相对直接。弦截法无需计算导数，计算复杂度较低，但迭代公式相对复杂一些，实现时需注意处理可能出现的除零等问题。

### 4.3 思考题

1. 如果将地球质量M增加，L1点的位置将如何变化？请给出物理解释。

如果将地球质量 M 增加，根据 L1 点位置方程\(\frac{GM}{r^{2}}-\frac{Gm}{(R - r)^{2}}=\omega^{2}r\) ，地球引力增大。为维持力的平衡，卫星需靠近地球，使地球引力减小（引力与距离平方成反比），同时月球引力和离心力也相应调整，所以 L1 点会更靠近地球。

2. 除了L1点外，地球-月球系统还有其他拉格朗日点（L2-L5）。这些点的位置如何确定？它们各自有什么特点？
对于地球 - 月球系统的 L2 - L5 点，L2 点在月球背向地球一侧，L3 点在地球另一侧与月球对称位置，L4 和 L5 点分别位于月球绕地轨道的前方和后方 60° 处。确定位置方法类似 L1 点，通过建立物体在这些点的受力平衡方程求解。L2 点可用于放置天文观测设备，减少地球光污染和辐射干扰；L3 点一般无实际应用价值；L4 和 L5 点存在一些天然的尘埃聚集等，在天体动力学研究中有重要意义。


## 5. 结论

总结本实验的主要发现和收获，包括对拉格朗日点物理意义的理解以及数值方法在天体力学问题中的应用。

本实验通过数值方法成功求解地球 - 月球系统 L1 拉格朗日点位置，深入理解了拉格朗日点的物理意义，即物体在该点所受地球引力、月球引力和离心力平衡，可相对地球和月球静止。在数值方法应用方面，掌握了牛顿法和弦截法的实现与特点，牛顿法收敛快但对初值敏感，弦截法相对稳健但收敛稍慢。同时，认识到这些数值方法在天体力学问题求解中的有效性和局限性，为进一步研究天体力学相关问题奠定了基础。

## 核心代码片段

请粘贴您实现的关键函数代码（如L1点位置方程和牛顿法实现），并简要说明代码的核心思路。

```python
def lagrange_equation(r):
    earth_gravity = G * M / (r ** 2)
    moon_gravity = G * m / ((R - r) ** 2)
    centrifugal_force = omega ** 2 * r
    return earth_gravity - moon_gravity - centrifugal_force

def lagrange_equation_derivative(r):
    earth_gravity_derivative = -2 * G * M / (r ** 3)
    moon_gravity_derivative = -2 * G * m / ((R - r) ** 3)
    centrifugal_force_derivative = omega ** 2
    return earth_gravity_derivative + moon_gravity_derivative - centrifugal_force_derivative

def newton_method(f, df, x0, tol=1e-8, max_iter=100):
    x = x0
    for i in range(max_iter):
        fx = f(x)
        dfx = df(x)
        if abs(dfx) < 1e-14:
            break
        x = x - fx / dfx
        if abs(f(x)) < tol:
            return x, i + 1, True
    return x, i + 1, False
```

代码说明：
lagrange_equation函数根据地球引力、月球引力和离心力平衡关系构建 L1 点位置方程。lagrange_equation_derivative函数计算该方程的导数，为牛顿法提供支持。newton_method函数实现牛顿法，通过迭代公式不断更新近似解，直到满足收敛条件或达到最大迭代次数 。
