# 探测周期性 - 实验报告

## 1. 实验目的

本实验旨在通过傅里叶变换分析太阳黑子数据的周期性，具体目标包括：
- 学习使用傅里叶变换分析时间序列数据中的周期性特征
- 掌握功率谱的计算和解释方法
- 理解太阳黑子活动的周期性规律及其物理意义

## 2. 方法简述

请简要描述您实现的算法和方法，特别是：
数据获取和预处理：采用np.loadtxt函数从本地文件读取太阳黑子数据，通过usecols参数指定选取年份和太阳黑子数所在列，同时利用comments参数跳过注释行。读取后将数据分别整理为年份数组与太阳黑子数数组，为后续分析奠定基础。
傅里叶变换的实现方式：借助numpy库中的np.fft.fft函数，对预处理后的太阳黑子数数组执行离散傅里叶变换操作。该操作将时域的太阳黑子数信号转换至频域，得到包含正负频率信息的变换结果。
功率谱的计算方法：对傅里叶变换后的结果取绝对值并平方，得到功率值，再除以数据长度以归一化，获取功率谱。鉴于变换结果的对称性，仅保留正频率部分对应的功率谱值，同时计算与之对应的正频率数组。
峰值检测和周期确定的策略：在功率谱数组中，排除零频率对应的功率值（因其通常为信号直流分量，非周期信息），使用np.argmax函数找出剩余功率谱中的最大值索引。该索引对应的频率的倒数，即为所确定的太阳黑子活动的主周期。


## 3. 实验结果

### 3.1 太阳黑子数据时间序列

请在此处粘贴您生成的太阳黑子数量随时间变化的图像，并简要说明您从图中观察到的周期性特征。

_在此处插入时间序列图像_

图像说明：
图像呈现出太阳黑子数量随时间波动的情况，能够明显观察到其数量并非稳定不变，而是每隔若干年便会出现一次峰值与谷值的交替，呈现出规律性的起伏变化，反映出太阳黑子活动具备周期性特征，大致周期在 10 - 12 年左右。

### 3.2 功率谱分析

请在此处粘贴您生成的功率谱图像，并标明主要峰值对应的周期。

_在此处插入功率谱图像_

图像说明：
功率谱图中，横坐标表示周期（单位为月），纵坐标为功率。图中的主要峰值对应周期约为 132 个月，这意味着在该周期上太阳黑子信号的能量最为集中，是太阳黑子活动的核心周期成分。
### 3.3 周期确定

请列出您通过不同方法确定的太阳黑子周期：

| 确定方法 | 周期（月） | 周期（年） |
|---------|----------|----------|
| 目视估计 |     130     |  10.83        |
| 傅里叶分析 |     132    |    11.0      |

两种方法的相对误差：_1。5%____

## 4. 分析与讨论

### 4.1 太阳黑子周期的物理意义

请讨论太阳黑子周期的物理成因及其对地球的影响：
太阳黑子形成的物理机制：太阳内部存在强烈的对流运动，会产生强大的磁场。当这些磁场浮现到太阳表面时，会抑制局部区域的对流能量传输，使得该区域温度相较于周围降低，从而在视觉上呈现出比周围暗的区域，即形成太阳黑子。
太阳黑子周期与太阳磁场活动的关系：太阳黑子周期与太阳磁场活动紧密相连。太阳磁场的极性大约每 11 年反转一次，一个完整的太阳磁活动周期约为 22 年，涵盖两个 11 年的黑子周期，且两个周期内磁场极性相反。太阳黑子数量的增减与太阳磁场的变化相互关联，黑子活动高峰期对应着太阳磁场活动的剧烈时期。
太阳黑子活动对地球的影响：在地球气候方面，太阳黑子活动增强时，释放的高能粒子和电磁辐射会影响地球大气的电离层和臭氧层，进而可能改变大气环流模式，导致部分地区降水、气温等气候要素出现异常。在通信系统方面，强烈的太阳黑子活动会干扰地球电离层，使得短波通信受到影响，信号传输出现中断或质量下降等问题。
### 4.2 傅里叶变换方法的优缺点

讨论使用傅里叶变换分析周期性信号的优缺点：
优势：傅里叶变换能够将复杂的时域信号分解为不同频率的正弦和余弦波叠加形式，能清晰地展示信号中所蕴含的周期性信息，对于平稳的周期性信号分析效果出色。同时，其具有高效的快速傅里叶变换（FFT）算法实现，计算速度快，在处理大规模数据时优势明显。
局限性：傅里叶变换是一种全局变换，它对信号进行整体分析，无法提供信号在局部时间内的频率信息。若太阳黑子数据存在非平稳特性，如包含长期趋势或突发的变化，傅里叶变换难以准确捕捉这些局部特征，分析结果可能受到干扰。此外，傅里叶变换基于信号是无限长且平稳的假设，对于有限长度的实际信号，可能会出现边界效应等问题。
其他方法及异同：小波变换可在时域和频域同时对信号进行分析，通过伸缩和平移母小波来适应信号的局部特征，对于非平稳信号的分析更为有效，但计算复杂度相对较高。自相关函数法通过计算信号与其自身在不同时间延迟下的相关性来检测周期性，简单直观，对噪声较为敏感，且不能像傅里叶变换那样全面地展示信号的频率成分分布。与傅里叶变换相比，小波变换更擅长处理非平稳信号，自相关函数法则更侧重于从信号自身相关性角度检测周期。
### 4.3 思考题

1. 如果太阳黑子数据中存在长期趋势（如逐年增加或减少的趋势），这会如何影响傅里叶分析的结果？应该如何处理这种趋势？

若太阳黑子数据存在长期趋势，傅里叶分析结果中低频部分功率会显著增大，这可能会掩盖或干扰真实周期信号对应的频率成分，导致周期判断出现偏差。处理时可先对数据进行去趋势处理，如采用线性回归方法拟合趋势线，然后从原始数据中减去该趋势线，消除长期趋势影响后再进行傅里叶分析。

2. 太阳黑子数据从1749年开始记录，到现在已有270多年的数据。如果我们只使用最近100年的数据进行分析，结果会有什么不同？为什么？

仅使用最近 100 年数据进行分析，结果的稳定性和可靠性可能降低。一方面，数据量减少会使统计特征代表性不足，周期计算可能存在较大误差；另一方面，若太阳活动模式在近 100 年发生了变化，可能只能反映近期特性，无法涵盖太阳活动的完整长期规律。但如果太阳活动在近期确实呈现新趋势，短期数据或许能更及时反映当前情况。

## 5. 结论

总结本实验的主要发现和收获，包括对太阳黑子周期性的认识以及傅里叶变换在周期性分析中的应用。

本实验借助傅里叶变换成功分析出太阳黑子活动周期约为 11 年。通过实验，深入了解到太阳黑子形成与太阳磁场的紧密关联，以及其活动对地球气候和通信系统等方面的重要影响。同时，认识到傅里叶变换在分析周期性信号时具备高效、直观展示频率成分等优势，但在处理非平稳信号时存在局限性。此次实验不仅深化了对太阳黑子周期性的认识，也提升了对傅里叶变换在周期性分析中应用的理解与掌握。

## 核心代码片段

请粘贴您实现的关键函数代码（如傅里叶变换和功率谱计算），并简要说明代码的核心思路。

```python
def compute_power_spectrum(sunspots):
    n = len(sunspots)
    fft_result = np.fft.fft(sunspots)
    power = np.abs(fft_result[:n//2])**2
    frequencies = np.fft.fftfreq(n, d=1)[:n//2]
    return frequencies, power

def find_main_period(frequencies, power):
    idx = np.argmax(power[1:]) + 1
    main_period = 1 / frequencies[idx]
    return main_period
```

代码说明：
compute_power_spectrum函数先对太阳黑子数数组执行傅里叶变换，随后取正频率部分计算功率谱，并确定对应的频率数组。find_main_period函数通过查找功率谱中除零频率外的最大功率索引，计算出该索引对应频率的倒数，从而确定太阳黑子活动的主周期。
