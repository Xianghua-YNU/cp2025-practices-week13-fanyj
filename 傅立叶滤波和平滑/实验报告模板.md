# 傅立叶滤波和平滑 - 实验报告

## 1. 实验目的

本实验旨在通过对道琼斯工业平均指数数据进行傅立叶变换和滤波处理，达到以下目标：
- 掌握傅立叶变换在金融时间序列分析中的应用
- 理解不同频率成分对信号的影响
- 学习通过频域滤波提取信号特征的方法
- 分析滤波参数变化对结果的影响

## 2. 方法简述

请简要描述您实现的算法和方法，特别是：
- 数据加载和预处理的方法
- 使用np.loadtxt函数从指定文件（dow.txt）加载道琼斯工业平均指数数据，若文件不存在或读取失败会抛出异常。加载的数据未经复杂预处理，直接用于后续分析。
- 傅立叶变换和逆变换的实现
- 利用numpy库的np.fft.rfft函数对输入数据进行实数傅立叶变换，得到傅立叶系数。之后通过np.fft.irfft函数对滤波后的系数进行逆变换，还原得到滤波后的数据。
- 滤波器的设计原理（保留前10%和前2%系数的实现）
- 计算傅立叶系数后，根据设定的保留比例（如 10% 或 2%），确定保留的系数数量。将其余超出数量的系数置为 0，从而实现保留低频主要成分，抑制高频成分的滤波效果。
- 可视化方法的选择
- 采用matplotlib.pyplot库进行可视化。通过plt.plot绘制数据曲线，设置title、xlabel、ylabel添加标题和坐标轴标签，用plt.grid添加网格线，调用plt.show展示图形，以直观呈现原始数据和滤波后数据的特征。

_在此处填写您的方法描述（约200-300字）_

## 3. 实验结果

### 3.1 原始数据时间序列

请在此处粘贴您生成的道琼斯工业平均指数原始数据时间序列图，并说明您从图中观察到的特征。

_在此处插入原始数据时间序列图像_

图像说明：
_从原始数据时间序列图中可观察到，道琼斯工业平均指数呈现出复杂的波动形态，存在短期的起伏以及一些相对长期的趋势变化，波动没有明显的规则周期性，反映出金融市场的不确定性和多变性。）_

### 3.2 保留前10%系数的滤波结果

请在此处粘贴您生成的保留前10%傅立叶系数的滤波结果图像，并说明：
1. 滤波后信号与原始信号的差异
2. 被抑制的频率成分对信号的影响

_在此处插入10%滤波结果图像_

图像说明：

图像说明：滤波后信号相较于原始信号，高频噪声明显减少，曲线更加平滑。被抑制的高频成分主要是信号中的短期剧烈波动部分，这些高频波动被滤除后，使得信号的长期趋势更加凸显。

### 3.3 保留前2%系数的滤波结果

请在此处粘贴您生成的保留前2%傅立叶系数的滤波结果图像，并说明：
1. 与10%滤波结果的对比
2. 更严格滤波对信号的影响

_在此处插入2%滤波结果图像_

图像说明：
与 10% 滤波结果相比，2% 滤波后的信号更加平滑。更严格的滤波进一步抑制了高频成分，使得信号几乎只保留了最主要的低频趋势部分。但同时，信号也丢失了一些相对高频的细节信息。

## 4. 分析与讨论

### 4.1 不同滤波参数的影响

请讨论：
- 保留10%系数与保留2%系数结果的差异
- 不同滤波强度对信号平滑程度的影响
- 过度滤波可能导致的问题

保留 10% 系数的滤波结果保留了一定的高频成分，信号相对保留了更多细节，平滑程度适中；而保留 2% 系数时，滤波更严格，高频成分几乎被完全抑制，信号过度平滑，丢失了较多细节信息。不同滤波强度下，滤波强度越大信号越平滑，但过度滤波会使信号失真，丢失重要的波动信息，可能导致无法准确反映市场短期变化。

### 4.2 金融时间序列的频率特征

讨论道琼斯指数中不同频率成分可能代表的经济现象：
- 低频成分（长期趋势）反映了什么经济因素？
- 高频成分（短期波动）通常由什么因素引起？

低频成分（长期趋势）反映了宏观经济形势、行业发展趋势、企业长期盈利能力等经济因素，代表着市场的总体发展方向。高频成分（短期波动）通常由突发的经济事件、政策变动、市场情绪波动、公司短期业绩公告等因素引起，体现了市场短期内的不确定性和投机性。
### 4.3 思考题

1. 如果我们对道琼斯指数数据进行对数变换后再进行傅立叶分析，结果会有什么不同？

对道琼斯指数数据进行对数变换后再进行傅立叶分析，数据的相对变化被强调，对数变换可将乘法关系转换为加法关系，可能使数据的频率结构发生变化。傅立叶分析结果中，高频和低频成分的幅度和相对比例可能改变，更能突出数据变化率的频率特征。

2. 傅立叶变换假设信号是周期性的，但金融数据通常不是严格周期性的。这会导致什么问题？

傅立叶变换假设信号是周期性的，但金融数据通常不是严格周期性的。这会导致频谱泄漏问题，即信号的能量在频谱上扩散，原本集中在特定频率的能量分散到相邻频率，使得频谱分析结果不准确，难以精确提取信号的真实频率成分。

## 5. 结论

总结本实验的主要发现和收获，包括：
- 傅立叶滤波在金融数据分析中的应用价值
- 不同滤波参数的选择经验
- 实验过程中遇到的挑战和解决方法

本实验表明傅立叶滤波在金融数据分析中可有效去除噪声、提取趋势，具有重要应用价值。选择滤波参数时，需在信号平滑和细节保留间权衡，较弱滤波可保留细节，较强滤波突出趋势但易失真。实验中遇到数据加载异常、滤波效果不理想等问题，通过完善错误处理、调整滤波参数解决

## 核心代码片段

请粘贴您实现的关键函数代码（如滤波函数实现），并简要说明代码的核心思路。

```python
def fourier_filter(data, keep_fraction=0.1):
    # 计算实数信号的傅立叶变换
    fft_coeff = np.fft.rfft(data)
    # 计算保留的系数数量
    cutoff = int(len(fft_coeff) * keep_fraction)
    # 创建滤波后的系数数组
    filtered_coeff = fft_coeff.copy()
    filtered_coeff[cutoff:] = 0
    # 计算逆变换
    filtered_data = np.fft.irfft(filtered_coeff, n=len(data))
    return filtered_data, fft_coeff
```

代码说明：
该函数先对输入数据进行傅立叶变换得到系数，接着依据保留比例确定截断位置，将截断位置后的系数置零实现滤波，最后通过逆变换得到滤波后的数据，整体实现了对数据的频域滤波处理。
